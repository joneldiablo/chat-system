(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{100:function(e,t,a){},110:function(e,t,a){},111:function(e,t,a){"use strict";a.r(t);var n=a(1),r=a.n(n),s=a(26),c=a.n(s),o=(a(69),a(11)),i=a(12),l=a(14),u=a(13),m=a(15),h=a(29),p=a(17),d=a(27),f=a(7),g=a.n(f),v=a(16),b=a(112),k=a(113),E=a(114),y=a(115),w=a(116),j=a(117),O=a(118),x=a(20),S=a.n(x),I="http://localhost:4000/api",M=(a(71),function(e){function t(){var e;return Object(o.a)(this,t),(e=Object(l.a)(this,Object(u.a)(t).call(this))).state={email:"htaverner0@engadget.com",pass:"gTcRuWDbwwI"},e}return Object(m.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){this.redir()}},{key:"onSubmit",value:function(){var e=Object(v.a)(g.a.mark(function e(t){var a,n;return g.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),a=S()(I,"login"),e.next=4,fetch(a,{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:this.state.email,password:this.state.pass})}).then(function(e){return e.json()}).catch(function(e){return console.error(e),!1});case 4:(n=e.sent).token||console.error(n),localStorage.setItem("token",n.token),localStorage.setItem("id",n.id),this.redir();case 9:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"onChangeField",value:function(e){this.setState(Object(d.a)({},e.target.name,e.target.value))}},{key:"redir",value:function(){localStorage.getItem("token")&&this.props.history.replace("/chat")}},{key:"render",value:function(){return r.a.createElement("div",{className:"login-view"},r.a.createElement(b.a,{className:"justify-content-center my-4"},r.a.createElement(k.a,{xs:"10",sm:"8",lg:"6",xl:"4"},r.a.createElement(E.a,{onSubmit:this.onSubmit.bind(this)},r.a.createElement(y.a,null,r.a.createElement(w.a,{for:"email"},"Email"),r.a.createElement(j.a,{type:"email",name:"email",id:"email",placeholder:"ex. name@email.com",value:this.state.email,onChange:this.onChangeField.bind(this),required:!0})),r.a.createElement(y.a,null,r.a.createElement(w.a,{for:"pass"},"Password"),r.a.createElement(j.a,{type:"password",name:"pass",id:"pass",placeholder:"********",value:this.state.pass,onChange:this.onChangeField.bind(this),required:!0})),r.a.createElement(b.a,{className:"justify-content-center"},r.a.createElement(k.a,{sm:"10",md:"6",lg:"4"},r.a.createElement(O.a,{block:!0,color:"primary"},"Submit")))))))}}]),t}(r.a.Component)),C=a(124),N=a(125),D=a(128),F=a(126),J=a(127),T=a(40),U=a(119),W=a(120),q=a(121),B=a(122),R=a(123),A=a(129),P=a(61),$=a.n(P),z=(a(99),function(e){function t(){var e;return Object(o.a)(this,t),(e=Object(l.a)(this,Object(u.a)(t).call(this))).state={messages:[],newMessage:""},e}return Object(m.a)(t,e),Object(i.a)(t,[{key:"componentDidUpdate",value:function(){var e=Object(v.a)(g.a.mark(function e(t){return g.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.props.location.pathname===t.location.pathname){e.next=3;break}return e.next=3,this.getMessages();case 3:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"componentDidMount",value:function(){var e=Object(v.a)(g.a.mark(function e(){var t,a=this;return g.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getMessages();case 2:(t=this.socket=$()(I.replace("/api","")+"?token="+this.token)).on("connect",function(){}),t.on("auth",function(){console.log("connection done")}),t.on("rejected",function(){delete a.token,localStorage.removeItem("token"),a.redir()}),t.on("newMessageReceived",function(e){var t=[].concat(Object(T.a)(a.state.messages),[e]);a.setState({messages:t})});case 7:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"getMessages",value:function(){var e=Object(v.a)(g.a.mark(function e(){var t,a,n;return g.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.redir()){e.next=16;break}return t=this.props.match.params.receiverId,a=S()(I,"private/messages",t),e.next=6,fetch(a,{headers:{token:this.token}}).then(function(e){return e.json()}).catch(function(e){return console.error(e),{error:!0}});case 6:if(!(n=e.sent).error){e.next=15;break}e.t0=n.status,e.next=401===e.t0?11:14;break;case 11:return delete this.token,localStorage.removeItem("token"),e.abrupt("return",this.redir());case 14:return e.abrupt("break",15);case 15:n&&this.setState({messages:n});case 16:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"redir",value:function(){var e=localStorage.getItem("token");return e?(this.token=e,!1):(this.props.history.replace("/"),!0)}},{key:"submitMessage",value:function(e){e.preventDefault();var t=this.props.match.params.receiverId,a={message:this.state.newMessage,receiverId:t,senderId:localStorage.getItem("id")};this.socket.emit("newMessage",a);var n=[].concat(Object(T.a)(this.state.messages),[a]);this.setState({messages:n,newMessage:""})}},{key:"onChange",value:function(e){this.setState(Object(d.a)({},e.target.name,e.target.value))}},{key:"render",value:function(){var e=this.props.match.params.receiverId;return r.a.createElement(r.a.Fragment,null,r.a.createElement(U.a,null,r.a.createElement(b.a,{className:"message-list"},this.state.messages.map(function(t,a){var n="",s=t.receiverId!=e;return n+=s?"":"offset-2",r.a.createElement(k.a,{xs:"10",key:a,className:"my-4 "+n},r.a.createElement(W.a,{color:s?"secondary":"primary",inverse:!s},r.a.createElement(q.a,null,t.message),r.a.createElement(B.a,{className:"text-right"},r.a.createElement("small",null,t.date))))})),r.a.createElement(b.a,null,r.a.createElement(k.a,null,r.a.createElement("div",{className:"send-message bg-white"},r.a.createElement("hr",null),r.a.createElement(E.a,{onSubmit:this.submitMessage.bind(this)},r.a.createElement(y.a,null,r.a.createElement(R.a,null,r.a.createElement(j.a,{placeholder:"write something...",value:this.state.newMessage,name:"newMessage",id:"newMessage",autoComplete:"off",onChange:this.onChange.bind(this)}),r.a.createElement(A.a,{addonType:"append"},r.a.createElement(O.a,{type:"submit",color:"primary"},"Send"))))))))))}}]),t}(r.a.Component)),G=(a(100),function(e){function t(){var e;return Object(o.a)(this,t),(e=Object(l.a)(this,Object(u.a)(t).call(this))).state={isOpen:!0,users:[]},e}return Object(m.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){var e=Object(v.a)(g.a.mark(function e(){var t,a;return g.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.redir()){e.next=14;break}return t=S()(I,"private/users"),e.next=5,fetch(t,{headers:{token:this.token}}).then(function(e){return e.json()}).catch(function(e){return console.error(e),{error:!0}});case 5:if(!(a=e.sent).error){e.next=13;break}e.t0=a.status,e.next=401===e.t0?10:12;break;case 10:return localStorage.removeItem("token"),e.abrupt("return",this.redir());case 12:return e.abrupt("break",13);case 13:a.data&&this.setState({users:a.data});case 14:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"redir",value:function(){var e=localStorage.getItem("token"),t=localStorage.getItem("id");return e?(this.token=e,this.id=t,!1):(this.props.history.replace("/"),!0)}},{key:"toggleUsers",value:function(){this.setState({isOpen:!this.state.isOpen})}},{key:"render",value:function(){var e=this,t=this.props.location.pathname.replace("/chat/","");return r.a.createElement(r.a.Fragment,null,r.a.createElement(b.a,null,r.a.createElement(k.a,{className:"user-list p-0",md:"4",xl:"3"},r.a.createElement(C.a,{color:"light",light:!0,expand:"md",className:"p-0 border-0 shadow-none"},r.a.createElement("div",null),r.a.createElement(N.a,{onClick:this.toggleUsers.bind(this)}),r.a.createElement(D.a,{isOpen:!this.state.isOpen,navbar:!0},r.a.createElement(F.a,{className:"w-100"},this.state.users.map(function(a){var n=t==a.id;return r.a.createElement(J.a,{key:a.id,active:n},r.a.createElement(h.b,{to:"/chat/"+a.id,className:n?"text-white":""},a.userName,e.id==a.id?r.a.createElement("b",null,"(ME)"):r.a.createElement(r.a.Fragment,null)))}))))),r.a.createElement(k.a,null,r.a.createElement(p.a,{path:"/chat/:receiverId",exact:!0,component:z}))))}}]),t}(r.a.Component)),H=(a(110),function(e){function t(){return Object(o.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"App container-fluid"},r.a.createElement(h.a,null,r.a.createElement(p.a,{path:"/",exact:!0,component:M}),r.a.createElement(p.a,{path:"/chat",component:G})))}}]),t}(r.a.Component));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(r.a.createElement(H,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},64:function(e,t,a){e.exports=a(111)},69:function(e,t,a){},71:function(e,t,a){},96:function(e,t){},99:function(e,t,a){}},[[64,1,2]]]);